# Prefect deployment configuration
# See https://docs.prefect.io/latest/deploy/

name: call-coach

prefect-version: 2.19.0

# Build section (empty for local execution)
build: null

# Push section (empty for local execution)
push: null

# Pull section - just ensure we're in the right directory
pull:
  - prefect.deployments.steps.set_working_directory:
      directory: /Users/gcoyne/src/prefect/call-coach

deployments:
  - name: bigquery-sync-scheduled
    description: Incremental sync of opportunities and calls from BigQuery (every 6 hours)
    entrypoint: flows/sync_bigquery_data.py:sync_bigquery_data
    parameters:
      sync_opportunities_flag: true
      sync_calls_flag: true
      full_sync: false
    schedule:
      cron: "0 */6 * * *"  # Every 6 hours
      timezone: "America/Los_Angeles"
    tags:
      - bigquery
      - sync
      - scheduled
    work_pool:
      name: default-agent-pool

  - name: bigquery-sync-manual
    description: Manual trigger for BigQuery sync (supports full refresh)
    entrypoint: flows/sync_bigquery_data.py:sync_bigquery_data
    parameters:
      sync_opportunities_flag: true
      sync_calls_flag: true
      full_sync: false
    tags:
      - bigquery
      - sync
      - manual
    work_pool:
      name: default-agent-pool
